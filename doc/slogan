Simple, fast and transparant generic derivation for typeclasses